@use 'sass:color';

@import './colors';
@import './grid.scss';

$divider-color: $white-a-70;
$divider-size: 3px;

$logo-size: 1.75rem;

$player-height: 200px;
$player-gap: 10px;
$player-corner-radius: 10px;
$player-padding: 20px;
$player-text-color: $white;

$player-thumbnail-size--mobile: 65px;
$player-thumbnail-size: 135px;

:export {
  playerGap: #{$player-gap};
  --divider-color: #{$divider-color};
  --divider-size: #{$divider-size};

  --player-thumbnail-size--mobile: #{$player-thumbnail-size--mobile};
  --player-thumbnail-size: #{$player-thumbnail-size};
}

.container {
  display: grid;
  align-content: center;
  width: 100vw;
  height: 100vh;

  touch-action: manipulation;
  -webkit-font-smoothing: antialiased;
  -webkit-tap-highlight-color: hsl(0 0% 0% / 0);
}

.main {
  position: relative;
  display: grid;
  grid-template-rows: $player-height;
  grid-auto-rows: 1fr;
  width: 100vw;
  overflow: hidden;

  margin-inline: auto;

  border-radius: $player-corner-radius;

  &.withCoverArt {
    $cover-size: min(100vh - $player-height, 100vw);
    width: $cover-size;
    grid-template-rows: $cover-size $player-height;
  }

  &.withPlaylist {
    height: 100vh;
  }

  &.withCoverArt,
  &.withPlaylist {
    border-radius: 0;
  }
}

.coverArt {
  display: grid;
}

.playerContainer {
  @include grid-stacked;

  .withCoverArt &,
  .withPlaylist & {
    position: relative;
    overflow: hidden;

    &::before,
    &::after {
      position: absolute;
      width: 100%;
      height: $divider-size;
      z-index: 1;

      background-color: $divider-color;
    }
  }

  .withCoverArt & {
    &::before {
      content: '';
      top: 0;
    }
  }

  .withPlaylist & {
    &::after {
      content: '';
      bottom: 0;
    }
  }
}

.background {
  z-index: -1;
}

.playerMain {
  --player-thumbnail-size: #{$player-thumbnail-size--mobile};

  display: grid;
  grid-template-columns: var(--player-thumbnail-size) 1fr max-content;
  grid-template-rows: max-content 1fr max-content;
  grid-template-areas:
    'THUMB TEXT  LOGO'
    'PANEL PANEL PANEL'
    'PROG  PROG  PROG';
  align-content: stretch;
  gap: $player-gap;
  margin: $player-padding;

  visibility: hidden;

  color: $player-text-color;

  .withCoverArt & {
    grid-template-areas:
      'TEXT  TEXT  LOGO'
      'PANEL PANEL PANEL'
      'PROG  PROG  PROG';
  }

  &:where([data-layout]) {
    visibility: visible;
  }

  &:where([data-layout='compact']) {
    .logo {
      display: none;
    }
    .menu {
      display: none;
    }
    .panel {
      --iconButton-size: clamp(20px, 12vw, 40px);
      --playButton-size: clamp(40px, 20vw, 60px);
    }
  }

  &:where([data-layout='compact-full'], [data-layout='extended-full']) {
    .menuToggle {
      display: none;
    }
    .panel {
      justify-content: space-between;
    }
    .controls {
      &.menuShown {
        display: flex;
      }
    }
    .menu {
      &.menuShown {
        display: flex;
      }
    }
  }

  &:where([data-layout^='extended']) {
    --player-thumbnail-size: #{$player-thumbnail-size};

    grid-template-areas:
      'THUMB TEXT  LOGO'
      'THUMB PANEL PANEL'
      'PROG  PROG  PROG';
  }

  &:where([data-layout='extended']) {
    .logo {
      display: none;
    }
    .menu {
      display: none;
    }
  }
}

.thumbnail {
  grid-area: THUMB;

  display: grid;
  width: var(--player-thumbnail-size);
  height: var(--player-thumbnail-size);
}

.text {
  grid-area: TEXT;
}

.logo {
  grid-area: LOGO;
  align-self: start;
}

.logoPrx {
  width: 80px;
  display: inline-block;
  vertical-align: -webkit-baseline-middle;
}

.panel {
  grid-area: PANEL;
  align-self: center;

  display: flex;
  justify-content: center;
  gap: $player-gap;

  line-height: 0;
}

.controls {
  display: flex;
  align-items: center;
  gap: 5px;

  &.menuShown {
    display: none;
  }
}

.menu {
  display: flex;
  align-items: center;
  gap: 5px;

  &.menuShown {
    display: flex;
  }
}

.menuToggle {
  grid-area: LOGO;
}

.progress {
  grid-area: PROG;
}

.playlist {
  overflow: hidden;
}

.modalMenu {
  display: flex;
  align-items: center;
  gap: 5px;
}
